---
layout: post
title:  "Environmental Impact of Agricultural Practices in the World"
description: our analysis.
---

# **ADA Project Milestone 3**

This notebook consists of our complete Data Analysis of the FAOSTAT dataset on Food an agriculture. 

In the previous Milestone, we have studied in detail the contents of the dataset, and restructured it in the appropriate forms, taking care of multiple discrepancies we had encountered. Now that the data is in the appropriate format, we will re-iterate our initial analysis of the data, and then answer all of our research questions.


```python
from glob import glob
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from fao_ada.pre_processing.load import load_dataframe
from fao_ada.utils import *
from fao_ada.plotting import *
from fao_ada.pre_processing.grouping import *

import seaborn as sns
sns.set_style("darkgrid")

%load_ext autoreload
%autoreload 2

country_groups = load_dataframe("data/country_groups.csv")
country_codes = load_dataframe("data/countries.csv")
population_df = load_dataframe("data_cleaned/population/Population_E_All_Data_(Normalized).csv")
```

    The autoreload extension is already loaded. To reload it, use:
      %reload_ext autoreload
    


```python
cleaned_files = glob("data_cleaned/**/*.csv")
```

Before doing any further step, we would like to check if, in the pre-processed data, we have any discrepancies regarding the mappings of items and elements


```python
print(check_mapping_multiple_files(cleaned_files, ['itemcode'], ['item']))
print(check_mapping_multiple_files(cleaned_files, ['elementcode'], ['element', 'unit']))
```

    Could not find column itemcode in data_cleaned/environment/Environment_Temperature_change_E_All_Data_(Normalized).csv
    True
    True
    

Looks good:
- The mapping itemcode <=> item is unique
- The mapping elementcode <=> (element, unit) is unique

---
---
# Part I: Exploration
---
---

---
## 1. What is the overall impact of the agriculture industry on global green house gas (GHG) emissions ?
---

This first question that naturally comes to mind. FAO provides data regarding emissions from multiple sectors. Green house gase emissions are computed using `CO2eq` (i.e. CO2 equivalent) from multiple gases (CO2, CH4, N20, and F-gases), which are in top list of Green House Gases.


```python
emissions_by_sector_df = pd.read_csv("data_cleaned/environment/Environment_Emissions_by_Sector_E_All_Data_(Normalized).csv")
emissions_by_sector_df = emissions_by_sector_df[emissions_by_sector_df.areacode.isin(country_groups['countrygroupcode'].unique())]
sns.set_palette(sns.color_palette("Paired", 11))

plot_stacked_bar_single_area_single_element(emissions_by_sector_df, elementcode=7263, areacode=5000, title="Worldwide shares of emissions by sector", ylabel="% of global emissions")
```


![png](assets/img/output_8_0.png)


It seems that agriculture has stayed around 10% of global emissions by sector for the years 1990-2010. Now we shall look at the share of this emissions for each gas, only looking at the World wide Agriculture emissions.


```python
plot_elements_pie_single_area(emissions_by_sector_df, elementcodes=[7264, 7265, 7266], areacode=5000, suptitle="Average shares of GHG emissions by sector (1990-2000 period)")
```


![png](assets/img/output_10_0.png)


From this pie chart, we can learn a few things for the Agriculture industry:
 - It seems that direct CO2 emissions from Agriculture are absent (0%). This makes sense as C02 is not directly emitted. However, the CO2 emissions might be indirect, as food is always transported via non carbon-free methods, and industrial machinery is used in agriculture, and requires energy.
 - Global CH4 Emissions are shared between Agriculture and Energy industries, with a majority for Agriculture (41.4%)
 - Global N2O are largely dominated by the Agriculture industry (70%)

All of these gases are considered top level Green House gases. It makes sense now to focus on searching where those emissions come from in detail (only for agriculture), and how can we reduce them without comprimising the diet of the population.

Now we know which GHG are largely emitted by the agriculture industry, and that Agriculture contributes to roughly 10% of global Emissions, but largely dominates other sectors in terms of CH4 and N2O emissions. 

However, this plot does not take into consideration indirect emissions due to Agriculture:
- Emissions due to transport of food (included in "Transport" sector)
- Emissions due to use of energy for producing agricultural products (included in "Energy")

Our analysis focuses more on the direct emissions of Agriculture, and hence we will not take those aspects in consideration as they fall outside of the scope.


### 1.1. What are the sources of CH4 and N2O emissions from in the Agriculture Industry ?
---

To illustrate this, we can separate the emissions of both gases into 10 items related to agriculture: Enteric Fermentation, Manure management, Rice Cultivation, Synthetic Fertilizers, Manure applied to soils, Manure left on Pasture, Crop residues, Burning of crop residues, Burning of savanna and Cultivation of organic Soils.



```python
emissions_agr_df = pd.read_csv("data_cleaned/emissions_agriculture/Emissions_Agriculture_Agriculture_total_E_All_Data_(Normalized).csv")
emissions_agr_df_grp = groupby_country_groups(emissions_agr_df, country_groups)
emissions_agr_df_grp = emissions_agr_df_grp[emissions_agr_df_grp.year < 2020]

```


```python

```




    1961




```python

```

    nan
    nan
    


    ---------------------------------------------------------------------------

    ValueError                                Traceback (most recent call last)

    <ipython-input-13-81854c885457> in <module>
    ----> 1 plot_world_map_slider(emissions_agr_df_grp[emissions_agr_df_grp.itemcode == 5058], "a", "a","a")
    

    c:\users\theop\onedrive\documents\github\ada_project\src\fao_ada\plotting.py in plot_world_map_slider(df, filename, title, heatbar_text)
        150 
        151     print(df.year.max())
    --> 152     year_max = int(df.year.max())
        153     year_min = int(df.year.min())
        154     total_years =  year_max - year_min
    

    ValueError: cannot convert float NaN to integer



```python
plot_elements_pie_single_area(emissions_agr_df_grp, [7225, 7230], 5000, "Average yearly shares of CH4 and N2O emissions for agriculture (1961-2017 period)", figsize=(15, 10), y_title=0.9)
```


![png](assets/img/output_16_0.png)


This pie chart illustrates quite well the origin of emissions of CH4 and N2O, in the agriculture industry. Before interpreting the chart, let's brievly explain what each item represents:
- Burning - Crop residues: Agricultural practice that consists of combusting a percentage of crop residues on site
- Burning - Savanna: Periodic prescribed burning of savanna for agricultural purposes
- Enteric Fermentation: Digestive process by which carbohydrates are broken down by micro organisms into simple molecules for absorption into the bloodstream of an animal.
- Manure Management: Refers to capture, storage, treatment, and utilization of animal manure
- Rice Cultivation: Agricultural practice for growing rice seeds
- Crop Resdiues: Agriculture management practice that consists in returning to managed soils the residual part of the produce
- Cultivation of Organic Soils:
- Manure applied to Soils: Animal waste distributed on fields in amounts that enrich soils
- Manure left on pasture: Animal waste left on managed soils from grazing livestock. 
- Synthetic Fertilizers: Inorganic material of synthetic origin added to a soil to supply one or more plant nutrients essential to the growth of plants.

1. CH4 Emissions:

    - Direct CH4 emissions of agriculture are mostly dominated by the Enteric Fermentation of Livestock (69.4%), which means that this particular source of emissions accounts for rougly 30% of the global CH4 Emissions, which is quite significant.
    - Rice Cultivation also is a big contributor (18%) to the emissions of this GHG.
    - Other sources have much lower contribution to emissions of this gas
    

2. N2O Emissions:
    - The biggest contributor is "Manure Left on Pasture", followed by Synthetic Fertilizers.
    - The use of Manure (Manure management, left on pasture, and applied to soils) have a contribution of roughly 40% (together) of N2O Emissions for agriculture.


### 1.2. How have global emissions of those gases from each source evolved in the past years ?
---
Having an average share of each source over the past 50 years gives us a general idea of where the emissions come from. Additionally, the evolution of emissions in this time frame is also interesting.

We all know Global emissions have increased worldwide, but what are the sources of this increase in the agricultural sector ?


```python
plot_stacked_bar_single_area_single_element(emissions_agr_df_grp, elementcode=7225, areacode=5000, title="Worldwide evolution of CH4 Emissions by source", ylabel="Gigagrams", bbox=(1.4, 0.5), width=0.5)
```


![png](assets/img/output_20_0.png)



```python
plot_stacked_bar_single_area_single_element(emissions_agr_df_grp, elementcode=7230, areacode=5000, title="Worldwide evolution of N2O Emissions by source", ylabel="Gigagrams", bbox=(1.5, 0.5), width=0.5)
```


![png](assets/img/output_21_0.png)


We can notice a clear linear increase in the emission of both gases , with a slight peak in 1990-1995. This is most probably due to previously missing data, as we can see that some items only start appearing around that period of time.

#### 1. Emissions of CH4:

As seen previously, we knew that CH4 emissions are dominated by the Enteric Fermentation, and we can see that it has increased by roughly 50% since 1961. However other sources do not seem to have had the same increase in emissions.

#### 2. Emissions of N2O:
Increases here are more interesting. We can see that emissions due to Synthetic fertilizers have increased linearly by almost 400%, with slightly lower steepness after ~1995. 
Manure Management's emissions also increased linearly.

### 1.3. Which countries contribute the most to emissions due to agriculture ?
---

We now have a global view on emissions worldwide, but it would be interesting to have a more detailed approach and see which countries countribute the most to the emissions of those 2 gases.

#### 1. Raw data
First we plot the total emissions in gigagrams for each country and gas (for CH4 and N2O) as a heatmap.


```python
SHAPE_FILE = "data/gpd_maps/ne_110m_admin_0_countries.shp"
titles = {7225: "Emissions of CH4 by country in 2017", 7230: "Emissions of N2O by country in 2017"}
plot_maps(emissions_agr_df, [7225, 7230], country_codes, 2017, SHAPE_FILE, titles=titles)
```


![png](assets/img/output_25_0.png)


It looks like 4-5 countries contribute much more than others to emissions of the two gases: China, India, United States, Brazil and Australia. However, these countries' populations are quite signifcant. Let's look at the same graph, but after normalizing by population.

#### 2. Normalized by population



```python
titles = {7225: "Emissions per capita of CH4 by country in 2017", 7230: "Emissions per capita of N2O by country in 2017"}

emissions_agr_df_norm = normalize_by_population(groupby_all_items_sum(emissions_agr_df), population_df)
plot_maps(emissions_agr_df_norm, [7225, 7230], country_codes, 2017, SHAPE_FILE, titles=titles)
```


![png](assets/img/output_28_0.png)


At a first glance, it seems that all countries have similar values of emission gigagrams/capita, but the scale tells us that some countries have higher values. Let's plot the distribution of values and check how it behaves.


```python
fig, ax = plt.subplots(figsize=(15, 5), ncols=2)
tmp1 = emissions_agr_df_norm[emissions_agr_df_norm.elementcode == 7225]
tmp2 = emissions_agr_df_norm[emissions_agr_df_norm.elementcode == 7230]
sns.distplot(tmp1['value'].dropna(), ax=ax[0])
ax[0].set_title("Distribution of CH4 emissions gigagrams/capita")
sns.distplot(tmp2['value'].dropna(), ax=ax[1])
ax[1].set_title("Distribution of N2O emissions gigagrams/capita");

```


![png](assets/img/output_30_0.png)


The values seem to be very concentrated around 0, but both distributions have a very long tail. This could be due to a faulty value for one or a couple of countries.

After further inspection, we saw that one country seems to stand out and has a much higher value: Falkland Islands, a small group of islands in the southern Atlantic, with a population of around 3000 people. These islands seem to have a quite high livestock/capita ratio, according to their website [Falkland Government Website](https://www.fig.gov.fk/agriculture/publications/farming-stastics/category/27-farming-statistics-2016-to-2020). For visualization purposes, we will drop this line and replot the maps.


```python
plot_maps(emissions_agr_df_norm[emissions_agr_df_norm.areacode != 65], [7225, 7230], country_codes, 2017, SHAPE_FILE, titles=titles)
```


![png](assets/img/output_32_0.png)


The map looks much better now. We can see which countries stand out: Australia and Mongolia seem to have a very high emission factor per capita for both gases.

### 1.4. Which countries contribute the most to emissions due to agriculture ?
---
Before pursuing further, it would also be useful to have an evolution of emissions of different countries over time. Such a visualization requires us to use interactive maps with a slider to change the years



```python

```

---
## 2. How has the agriculture industry evolved in the time frame ?
---
Now that we have a general idea on the different gas emissions due to agriculture, as well as information on which countries contribute to emissions, we will look through a different lens, and study the evolution of the industry over the given time frame

### 2.1. What kind of crops/livestock increased in production in this time frame ?
---
We will now shift our focus to production of various crops and livestock. The data is separated in 3 categories: Livestock (live animals), Livestock produce (meat, eggs, etc..) and Crops.

#### 1. Evolution of Livestock stocks


```python
from fao_ada.pre_processing.grouping import groupby_item_groups
livestock_df = pd.read_csv("data_cleaned/production/Production_Livestock_E_All_Data_(Normalized).csv")
livestock_df_grpd = groupby_country_groups(livestock_df, country_groups)

```


```python
sns.set_palette(sns.color_palette("Paired", 11))
plot_stacked_bar_single_area_single_element(livestock_df_grpd, elementcode=5111, areacode=5000, title="Evolution of Livestock stocks (Heads)", ylabel="Heads", bbox=(1.3, 0.5), width=0.5)
sns.set_palette(sns.color_palette("Paired", 7))
plot_stacked_bar_single_area_single_element(livestock_df_grpd, elementcode=5112, areacode=5000, title="Evolution of Livestock stocks (1000 Heads)", ylabel="1000 Heads", bbox=(1.4, 0.5), width=0.5)
```


![png](assets/img/output_40_0.png)



![png](assets/img/output_40_1.png)


As expected, of course, all stocks of live animals have increased. These take into consideration all animals used to produce food: it can be dairy cattle, layer chicken etc.. 

Now we normalize by population to see if the increase is proportional to the increase in population


```python
livestock_df_grpd_norm = normalize_by_population(livestock_df_grpd, population_df)
sns.set_palette(sns.color_palette("Paired", 11))
plot_stacked_bar_single_area_single_element(livestock_df_grpd_norm, elementcode=5111, areacode=5000, title="Evolution of Livestock stocks (Heads/capita)", ylabel="Heads", bbox=(1.3, 0.5), width=0.5)
sns.set_palette(sns.color_palette("Paired", 7))
plot_stacked_bar_single_area_single_element(livestock_df_grpd_norm, elementcode=5112, areacode=5000, title="Evolution of Livestock stocks (1000 Heads/capita)", ylabel="1000 Heads/capita", bbox=(1.4, 0.5), width=0.5)
```


![png](assets/img/output_42_0.png)



![png](assets/img/output_42_1.png)


Surprisingly, the amount of "Sheep and Goats" and "Cattle and Buffaloes" per capita seems to be decreasing, while for Poultry birds it is clearly increasing. 
This could be due to multiple factors:
- Cattle, Sheep and Goats need more time to grow, enducing a higher cost in production
- Poultry Birds are cheaper to feed, need less space to grow, and we have developped techniques where they can be stacked by millions easily, which is not the case for bigger animals.
- The increase in population was more dominant in countries where Red meat consumption is lower (India).
- People prefer to eat chicken today rather than in the 60s

#### 2. Evolution of production of Livestock products


```python
livestock_prim_df = pd.read_csv("data_cleaned/production/Production_LivestockPrimary_E_All_Data_(Normalized).csv")
livestock_prim_itemgroups = load_dataframe("data/item_groups/Production_Livestock_Primary_All_data.csv")
get_itemgroups_intersections(livestock_prim_itemgroups)

print("\n Elements in DF: \n")
print_all_elements(livestock_prim_df)
```

    Intersection on Meat, Total (1765) and Meat indigenous, total (1770) on {(1163, 'Meat, game'), (1176, 'Snails, not sea'), (1166, 'Meat nes')}
    Intersection on Meat, Total (1765) and Beef and Buffalo Meat (1806) on {(867, 'Meat, cattle'), (947, 'Meat, buffalo')}
    Intersection on Meat, Total (1765) and Sheep and Goat Meat (1807) on {(977, 'Meat, sheep'), (1017, 'Meat, goat')}
    Intersection on Meat, Total (1765) and Meat, Poultry (1808) on {(1073, 'Meat, goose and guinea fowl'), (1069, 'Meat, duck'), (1058, 'Meat, chicken'), (1089, 'Meat, bird nes'), (1080, 'Meat, turkey')}
    Intersection on Meat indigenous, total (1770) and Meat indigenous, poultry (1775) on {(1087, 'Meat indigenous, turkey'), (1084, 'Meat indigenous, bird nes'), (1094, 'Meat indigenous, chicken'), (1070, 'Meat indigenous, duck'), (1077, 'Meat indigenous, geese')}
    
     Elements in DF: 
    
          elementcode                        element       unit
    0            5313                         Laying  1000 Head
    57           5410                          Yield   100mg/An
    114          5510                     Production     tonnes
    171          5320  Producing Animals/Slaughtered       Head
    224          5420                          Yield      hg/An
    330          5322                     Production       Head
    383          5417           Yield/Carcass Weight      hg/An
    648          5323                     Production  1000 Head
    701          5424           Yield/Carcass Weight    0.1g/An
    1467         5321  Producing Animals/Slaughtered  1000 Head
    2037         5318                   Milk Animals       Head
    

We can ommit the itemgroup `Meat, total` as it comprises of all other item groups related to meat, and drop the elements that are not summable (related to yield).
Also, we need to be careful as `Meat indigenous, total` intersects with `Meat indigenous, poultry`


```python
livestock_prim_df_grpd = groupby_item_groups(livestock_prim_df, livestock_prim_itemgroups, drop_elements=[5410, 5420, 5417, 5424], except_={1765: ("Other Meat", 10001)})
livestock_prim_df_grpd = groupby_country_groups(livestock_prim_df_grpd, country_groups)
sns.set_palette(sns.color_palette("Paired", 9))
plot_stacked_bar_single_area_single_element(livestock_prim_df_grpd, elementcode=5510, areacode=5000, title="Evolution of Livestock produce production", ylabel="Tonnes", bbox=(1.4, 0.5), width=0.5)
```


![png](assets/img/output_47_0.png)


There seems to be a drop in production of `Meat indegenous, total` and `Meat indigenous, poultry`, and after inspection, it seems this data is missing for the years 2014 up to 2017. If we need to, we can use time series to complete the items related to this itemgroup for each country.

Also, we can notice clear drastic increases in all productions, but we need to factor in the growth in population too. For that, we normalize by the world population as done earlier


```python
livestock_prim_df_grpd_norm = normalize_by_population(livestock_prim_df_grpd, population_df)
plot_stacked_bar_single_area_single_element(livestock_prim_df_grpd_norm, elementcode=5510, areacode=5000, title="Evolution of Livestock produce production (tonnes/capita)", ylabel="Tonnes/capita", bbox=(1.4, 0.5), width=0.5)
```


![png](assets/img/output_49_0.png)


What this graph tells us:
- The overall production of livestock produce did not increase a lot (per capita) during 1961-1995, but took quite a signifcant upward trend in the last 2 decades (1995-2015).
- Beef/buffalo meat did not increase a lot in terms of tonnes/capita, as well as Milk production.
- The most flagrant increases in tonnes/capita are in `poultry` mean (`indegenous` and regular)

# MAYBE ADD MAP OF COUNTRIES' TOP PRODUCTION

#### 3. Evolution of Crops production


```python
crops_df = pd.read_csv("data_cleaned/production/Production_Crops_E_All_Data_(Normalized).csv")
crops_itemgroups = load_dataframe("data/item_groups/Production_Crops_All_data.csv")
print(f"The elements are: \n")
print_all_elements(crops_df)
```

    The elements are: 
    
        elementcode         element    unit
    0          5312  Area harvested      ha
    43         5419           Yield   hg/ha
    85         5510      Production  tonnes
    

The `itemgroups` here are quite overlapping, and it is hard to actually decide which to drop and which not. For visualization purposes, we will keep all item groups, but the some itemgroups intersect and are not exclusive


```python
crops_df_grpd = groupby_item_groups(crops_df, crops_itemgroups, drop_elements=[5419], except_={1714: ("Other Crops", 10002)})
crops_df_grpd = groupby_country_groups(crops_df_grpd, country_groups)
```


```python
sns.set_palette(sns.color_palette("husl", 13))
plot_stacked_bar_single_area_single_element(crops_df_grpd, elementcode=5510, areacode=5000, title="Evolution of Crops Production (tonnes)", ylabel="Tonnes", width=0.5)
```


![png](assets/img/output_56_0.png)



```python
crops_df_grpd_norm = normalize_by_population(crops_df_grpd, population_df)
line_plot_single_element_single_area(crops_df_grpd_norm, elementcode=5510, areacode=5000, title="Evolution of Crops Production (Tonnes/Capita)", ylabel="Tonnes/capita")
```


![png](assets/img/output_57_0.png)


### INTERPRETATION
Answer the questions of readme

### 2.2. How did Synthetic Fertilizer use change over time ? And what is was it's effect on production/yield and GHG emissions ?
---

This question is more related to crops. This type of Fertilizers started being used in the beginnin of the 20th century, after Fritz Haber inventing Haber–Bosch process, a method used in industry to synthesize ammonia from nitrogen gas and hydrogen gas.[[1]](https://en.wikipedia.org/wiki/Fritz_Haber)

# NEED TO FIND A WAY TO COMBINE ARCHIVE DATA AND 


```python
fertilizer_df = pd.read_csv("data_cleaned/emissions_agriculture/Emissions_Agriculture_Synthetic_Fertilizers_E_All_Data_(Normalized).csv")
#fertilizer_df = fertilizer_df[fertilizer_df.year < 2020]
fertilizer_df_grpd = groupby_country_groups(fertilizer_df, country_groups, drop_elements=[72293])
```

#### 1. History of use


```python
line_plot_single_element_single_area(fertilizer_df_grpd, elementcode=5163, areacode=5000, title="Agricultural use of Synthetic fertilizers (kg)", ylabel="kg")
```


![png](assets/img/output_63_0.png)



```python
print_all_elements(fertilizer_df_grpd)
```

         elementcode                                            element  \
    0         5163.0                                   Agricultural Use   
    41      516201.0  Nitrogen fertilizer content applied that volat...   
    82      516202.0   Nitrogen fertilizer content applied that leaches   
    123       5162.0                      Agricultural Use in nutrients   
    236      72303.0            Emissions (N2O) (Synthetic fertilizers)   
    295      72313.0          Emissions (CO2eq) (Synthetic fertilizers)   
    354      72343.0     Direct emissions (N2O) (Synthetic fertilizers)   
    413      72353.0   Direct emissions (CO2eq) (Synthetic fertilizers)   
    472      72363.0   Indirect emissions (N2O) (Synthetic fertilizers)   
    531      72373.0  Indirect emissions (CO2eq) (Synthetic fertiliz...   
    590     723631.0  Indirect emissions (N2O that volatilises) (Syn...   
    649     723632.0  Indirect emissions (N2O that leaches) (Synthet...   
    
                    unit  
    0                 kg  
    41   kg of nutrients  
    82   kg of nutrients  
    123  kg of nutrients  
    236        Gigagrams  
    295        Gigagrams  
    354        Gigagrams  
    413        Gigagrams  
    472        Gigagrams  
    531        Gigagrams  
    590        Gigagrams  
    649        Gigagrams  
    


```python
fertilizer_df_grpd[fertilizer_df_grpd.itemcode == 3107]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>itemcode</th>
      <th>item</th>
      <th>elementcode</th>
      <th>element</th>
      <th>unit</th>
      <th>year</th>
      <th>value</th>
      <th>areacode</th>
      <th>area</th>
      <th>flag</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>236</th>
      <td>3107.0</td>
      <td>Synthetic Nitrogen fertilizers</td>
      <td>72303.0</td>
      <td>Emissions (N2O) (Synthetic fertilizers)</td>
      <td>Gigagrams</td>
      <td>1961</td>
      <td>2.3096</td>
      <td>420</td>
      <td>Sub-Saharan Africa</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>237</th>
      <td>3107.0</td>
      <td>Synthetic Nitrogen fertilizers</td>
      <td>72303.0</td>
      <td>Emissions (N2O) (Synthetic fertilizers)</td>
      <td>Gigagrams</td>
      <td>1962</td>
      <td>2.6373</td>
      <td>420</td>
      <td>Sub-Saharan Africa</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>238</th>
      <td>3107.0</td>
      <td>Synthetic Nitrogen fertilizers</td>
      <td>72303.0</td>
      <td>Emissions (N2O) (Synthetic fertilizers)</td>
      <td>Gigagrams</td>
      <td>1963</td>
      <td>3.1108</td>
      <td>420</td>
      <td>Sub-Saharan Africa</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>239</th>
      <td>3107.0</td>
      <td>Synthetic Nitrogen fertilizers</td>
      <td>72303.0</td>
      <td>Emissions (N2O) (Synthetic fertilizers)</td>
      <td>Gigagrams</td>
      <td>1964</td>
      <td>3.8990</td>
      <td>420</td>
      <td>Sub-Saharan Africa</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>240</th>
      <td>3107.0</td>
      <td>Synthetic Nitrogen fertilizers</td>
      <td>72303.0</td>
      <td>Emissions (N2O) (Synthetic fertilizers)</td>
      <td>Gigagrams</td>
      <td>1965</td>
      <td>4.3013</td>
      <td>420</td>
      <td>Sub-Saharan Africa</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>36376</th>
      <td>3107.0</td>
      <td>Synthetic Nitrogen fertilizers</td>
      <td>723632.0</td>
      <td>Indirect emissions (N2O that leaches) (Synthet...</td>
      <td>Gigagrams</td>
      <td>2015</td>
      <td>157.0566</td>
      <td>9011</td>
      <td>Upper-middle-income economies</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>36377</th>
      <td>3107.0</td>
      <td>Synthetic Nitrogen fertilizers</td>
      <td>723632.0</td>
      <td>Indirect emissions (N2O that leaches) (Synthet...</td>
      <td>Gigagrams</td>
      <td>2016</td>
      <td>163.2550</td>
      <td>9011</td>
      <td>Upper-middle-income economies</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>36378</th>
      <td>3107.0</td>
      <td>Synthetic Nitrogen fertilizers</td>
      <td>723632.0</td>
      <td>Indirect emissions (N2O that leaches) (Synthet...</td>
      <td>Gigagrams</td>
      <td>2017</td>
      <td>163.7264</td>
      <td>9011</td>
      <td>Upper-middle-income economies</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>36379</th>
      <td>3107.0</td>
      <td>Synthetic Nitrogen fertilizers</td>
      <td>723632.0</td>
      <td>Indirect emissions (N2O that leaches) (Synthet...</td>
      <td>Gigagrams</td>
      <td>2030</td>
      <td>179.7106</td>
      <td>9011</td>
      <td>Upper-middle-income economies</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>36380</th>
      <td>3107.0</td>
      <td>Synthetic Nitrogen fertilizers</td>
      <td>723632.0</td>
      <td>Indirect emissions (N2O that leaches) (Synthet...</td>
      <td>Gigagrams</td>
      <td>2050</td>
      <td>194.4149</td>
      <td>9011</td>
      <td>Upper-middle-income economies</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>24296 rows × 11 columns</p>
</div>




```python
fertilizer_df_grpd[fertilizer_df_grpd.itemcode == 3107][['element', 'unit']].drop_duplicates()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>element</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>228</th>
      <td>Emissions (N2O) (Synthetic fertilizers)</td>
      <td>Gigagrams</td>
    </tr>
    <tr>
      <th>285</th>
      <td>Emissions (CO2eq) (Synthetic fertilizers)</td>
      <td>Gigagrams</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Direct emissions (N2O) (Synthetic fertilizers)</td>
      <td>Gigagrams</td>
    </tr>
    <tr>
      <th>399</th>
      <td>Direct emissions (CO2eq) (Synthetic fertilizers)</td>
      <td>Gigagrams</td>
    </tr>
    <tr>
      <th>456</th>
      <td>Indirect emissions (N2O) (Synthetic fertilizers)</td>
      <td>Gigagrams</td>
    </tr>
    <tr>
      <th>513</th>
      <td>Indirect emissions (CO2eq) (Synthetic fertiliz...</td>
      <td>Gigagrams</td>
    </tr>
    <tr>
      <th>570</th>
      <td>Indirect emissions (N2O that volatilises) (Syn...</td>
      <td>Gigagrams</td>
    </tr>
    <tr>
      <th>627</th>
      <td>Indirect emissions (N2O that leaches) (Synthet...</td>
      <td>Gigagrams</td>
    </tr>
  </tbody>
</table>
</div>




```python
print_all_items(fertilizer_df_grpd)
```

         itemcode                            item
    0      1360.0         Nitrogenous fertilizers
    123    3102.0     Nutrient nitrogen N (total)
    228    3107.0  Synthetic Nitrogen fertilizers
    


```python

```
